'use strict';

var session    = require('../middleware').session;
var RedisStore = require('../middleware').redis;
var config     = require('../../config');

var cookie = {
  path: '/',
  httpOnly: true,
  maxAge: 3600000 * 24 * 365,
  signed: false
};

var key = '';//'koa.sid';
var options = {
  key: key,
  cookie: cookie,
  defer: true,
  secret: config.sessionSecret
};

if (!config.debug) {
  options.store = config.sessionStore || new RedisStore(config.session);
}

module.exports = session(options);

